# Development Plan

This plan is optimized for "daily use" and long-term maintainability. Each milestone should keep the tool usable.

## v0.1 (Shipped)

Done:
- CLI: `init`, `scan`, `log`, `context`, `print`
- Repo scan (git-aware) -> `.repo-memory/manifest.json` + `.repo-memory/index.json`
- Context Pack generator -> `.repo-memory/context.md`

## v0.2 (Make Memory More Useful) (Shipped)

Goals:
- Produce a better "project memory" without tying to any specific repo type.
- Reduce manual work to keep rules/todos/journal consistent.

Done:
- Add `rmemo status` (+ `--format md|json` + `--mode brief|full`):
  - Summarize "Next / Blockers / Recent log" from `.repo-memory/*`
  - Output should be pasteable to issues/PR descriptions
- Improve scan heuristics:
  - Detect monorepo candidates (workspaces, pnpm, turborepo, packages/apps)
  - Detect common app folders (web/admin/backend/miniapp/mp) as hints only
  - Detect API contract files and doc roots (openapi/swagger/docs)
- Add `rmemo start` as a daily entrypoint (scan + context + status brief)
- Add todo helpers: `rmemo todo add|block|ls`

## v0.3 (Rules Become Enforceable) (Shipped)

Goals:
- Prevent "AI drift" by making key conventions executable.

Done:
- Add `.repo-memory/rules.json` (generated by `init`):
  - Structure rules: required dirs/files, forbidden paths, naming regexes
- Add `rmemo check`:
  - Validate repo against rules.json (no network)
  - Exit code for CI usage
  - Print actionable diff-like messages
- Add forbidden content scanning: `forbiddenContent`
- Add `--staged` mode (pre-commit optimized, reads staged content from git index)
- Add `rmemo hook install`:
  - Install a pre-commit hook to run `rmemo check` (opt-in)

## v0.4 (Workflow: Start/Stop The Day) (Shipped)

Goals:
- Make the daily routine effortless.

Done:
- Add `rmemo done`:
  - Promptless mode: take stdin to append to journal
  - Optionally extract "next steps" into todos.md
- Unify journal format for `log/done`
- Add todo lifecycle: `rmemo todo done|unblock` (remove by index)

## v0.5 (Polish + Adoption) (Shipped)

Goals:
- Make it easy for others to adopt.

Done:
- Add packaging metadata:
  - repository/homepage/bugs fields
  - `files` allowlist for npm
  - `npm pack --dry-run` in CI
- Prepare npm publishing:
  - scoped package: `@xiaofandegeng/rmemo`
  - release workflows: dry-run + publish
- Add docs:
  - "How I use this with Cursor/Claude/ChatGPT" (docs/USAGE.*)
  - Built-in templates + how to apply (web admin / miniapp)
- Add `CHANGELOG.md` + `CONTRIBUTING.md` + `RELEASING.md`
- Update docs to include npm install usage

## v0.6 (Optional)

Done:
- `rmemo scan --format md|json` to print scan results to stdout
- `rmemo check` output improvements (grouping + hints)
- `rmemo check --format json`

Remaining ideas:
- `rmemo scan --format md` optionally include a short "subprojects summary" table
- `rmemo check` output: optional `--max-violations <n>` and show stable ordering

## v0.7 (AI Tool Integration) (In Progress)

Goals:
- Make project memory "stick" inside AI tools that support repo-local instruction files.
- Keep instruction files generated and consistent across days and contributors.

Done:
- Add `rmemo sync` to generate instruction files from `.repo-memory/`:
  - `AGENTS.md`
  - `.github/copilot-instructions.md`
  - `.cursor/rules/rmemo.mdc`
- Add `--check/--dry-run/--targets/--force` flags and smoke tests

## v0.8 (Always-On Workflow) (In Progress)

Goals:
- Make the workflow "set and forget" for each repo.
- Keep instruction files fresh automatically via git hooks.

Done:
- Add `.repo-memory/config.json` to store sync defaults (targets).
- Add `rmemo setup` to install hooks:
  - `pre-commit`: `rmemo check --staged` (blocking)
  - `post-commit/post-merge/post-checkout`: `rmemo sync` (non-blocking)
- Add `rmemo setup --check` and `rmemo setup --uninstall` for audit and rollback

## v0.9 (Handoff Pack) (In Progress)

Goals:
- Generate a single, paste-ready markdown "handoff" for AI sessions.
- Include brief status, recent journal, and git change summary.

Done:
- Add `rmemo handoff` to update scan/context and generate `.repo-memory/handoff.md`

## v1.0 (PR Assistant) (In Progress)

Goals:
- Generate a PR-ready markdown summary (commits/files + brief status).
- Make it easy to paste into GitHub/GitLab PR descriptions.

Done:
- Add `rmemo pr` to generate `.repo-memory/pr.md` (supports `--base`, `--format json`, `--no-refresh`)

## v1.1 (GitHub PR Automation) (In Progress)

Goals:
- Auto-run `rmemo check` on pull requests.
- Auto-generate PR summaries and post them as artifacts and PR comments.

Done:
- Add GitHub Actions workflow: `.github/workflows/pr-assistant.yml`

## v1.2 (Watch Mode) (In Progress)

Goals:
- Keep `.repo-memory/context.md` and instruction files fresh while you work.
- Avoid requiring external deps (no chokidar).

Done:
- Add `rmemo watch` (poll-based) with `--interval`, `--once`, and `--no-sync`

## v1.3 (Monorepo Workspaces) (In Progress)

Goals:
- Make `--root <subdir>` behave correctly in git repos (scope file listing).
- Provide a first-class monorepo UX to run rmemo commands in subprojects.

Done:
- Scope `git ls-files` to `--root` subdir when `--root` is inside a git repo
- Add `rmemo ws` (workspace helper) to list/detect subprojects and run commands inside them

## v1.4 (Workspace Batch) (In Progress)

Goals:
- Batch-generate handoff/pr/sync/start across all detected subprojects.
- Write a monorepo-level summary file for quick navigation.

Done:
- Add `rmemo ws batch ...` and write `.repo-memory/ws.md` at repo root

## v1.5 (Profiles) (Shipped)

Goals:
- Make adoption near-zero effort for common repo types (admin web, miniapp, backend, monorepo).
- Encode team defaults in a reusable profile: rules, todos seed, config defaults.
- Allow safe upgrades over time.

Done:
- Add `rmemo profile ls/describe/apply`
- Add `rmemo init --auto` (detect + apply recommended profile)
- Add profile drift + upgrades:
  - `rmemo profile check` (drift report)
  - `rmemo profile upgrade` (re-apply template + backups)

## v1.6 (Sessions) (Shipped)

Goals:
- Make daily work trackable as a sequence of "sessions" (start -> notes -> end).
- Each session should produce a deterministic handoff pack for AI, without manual copy/paste.

Done:
- Add `rmemo session start|note|end|ls|show`
- Each session stored in `.repo-memory/sessions/<id>/`:
  - `meta.json` (schema, startedAt/endedAt, git branch/head when available)
  - `notes.md` (human notes)
  - `handoff.md` + `context.md` snapshots (generated at end)

## v1.7 (Repo Memory API) (Shipped)

Goals:
- Let AI tools fetch repo memory without copy/paste.
- Keep it local-first and safe (no outbound network, read-only by default).

Done:
- Add `rmemo serve` (local HTTP API; read-only by default)
- Endpoints:
  - `GET /status` (json|md)
  - `GET /context`
  - `GET /manifest` + `GET /index`
  - `GET /rules` + `GET /rules.json`
  - `GET /todos` (md|json)
  - `GET /handoff` + `GET /pr` (serve existing files; optional refresh)
  - `GET /journal` + `GET /journal/YYYY-MM-DD.md`
  - `GET /search?q=...` (search rules/todos/context/manifest/journal)
- Token auth support: `--token` / `RMEMO_TOKEN`

## v1.8 (MCP Server) (Planned)

Goals:
- Provide the same capabilities over stdio for AI tools that support MCP.

Done:
- `rmemo mcp` MCP stdio server (JSON-RPC, one JSON per line; logs to stderr)
- Tools:
  - `rmemo_status`
  - `rmemo_context` (supports refresh)
  - `rmemo_rules`
  - `rmemo_todos` (md/json)
  - `rmemo_handoff` (md/json, supports refresh)
  - `rmemo_pr` (md/json, supports refresh)
  - `rmemo_search` (keyword search)

## v1.9 (Semantic Memory) (Planned)

Goals:
- Make "memory retrieval" work even when you don't remember the exact keyword.
- Keep it local-first: build an embeddings index under `.repo-memory/` and search it.
- Expose the same capability over CLI/HTTP/MCP.

Planned:
- `rmemo embed build`:
  - Build `.repo-memory/embeddings/index.json`
  - Provider options: `mock` (default, deterministic) and `openai` (optional)
- `rmemo embed search <query>`:
  - Return top-k matching chunks with scores and snippets
- HTTP:
  - `GET /search?mode=semantic&q=...` uses the embeddings index
- MCP:
  - Extend `rmemo_search` to support `mode=semantic`
